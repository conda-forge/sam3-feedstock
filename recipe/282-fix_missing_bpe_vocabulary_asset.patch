From ff80b6d1b9e4a015ff5f457781b54e33675c048f Mon Sep 17 00:00:00 2001
From: Clay Dugo <claydugo@gmail.com>
Date: Tue, 2 Dec 2025 09:24:00 -0500
Subject: [PATCH] Fix missing BPE vocabulary asset in non-editable install

https://github.com/facebookresearch/sam3/pull/282
---
 pyproject.toml        | 3 +++
 sam3/model_builder.py | 4 ++--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/pyproject.toml b/pyproject.toml
index 5fd6d5e0..c7fc091d 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -85,6 +85,9 @@ train = [
 [tool.setuptools.packages.find]
 include = ["sam3*"]
 
+[tool.setuptools.package-data]
+sam3 = ["assets/*.txt.gz"]
+
 [tool.setuptools.dynamic]
 version = {attr = "sam3.__version__"}
 
diff --git a/sam3/model_builder.py b/sam3/model_builder.py
index 058bbec3..66719276 100644
--- a/sam3/model_builder.py
+++ b/sam3/model_builder.py
@@ -581,7 +581,7 @@ def build_sam3_image_model(
     """
     if bpe_path is None:
         bpe_path = os.path.join(
-            os.path.dirname(__file__), "..", "assets", "bpe_simple_vocab_16e6.txt.gz"
+            os.path.dirname(__file__), "assets", "bpe_simple_vocab_16e6.txt.gz"
         )
     # Create visual components
     compile_mode = "default" if compile else None
@@ -669,7 +669,7 @@ def build_sam3_video_model(
     """
     if bpe_path is None:
         bpe_path = os.path.join(
-            os.path.dirname(__file__), "..", "assets", "bpe_simple_vocab_16e6.txt.gz"
+            os.path.dirname(__file__), "assets", "bpe_simple_vocab_16e6.txt.gz"
         )
 
     # Build Tracker module
